# SupersetEmbed Vue Component Documentation

## Overview

The `SupersetEmbed.vue` component is a Vue 3 component that allows you to embed Apache Superset dashboards into your Vue application. This component uses the `@superset-ui/embedded-sdk` package to seamlessly integrate Superset dashboards with authentication through guest tokens.

## Prerequisites

Before using this component, ensure you have:

1. A Vue 3 project set up with Vite
2. Apache Superset instance running and accessible
3. A dashboard created in Superset that you want to embed
4. Guest token authentication configured in your Superset instance

## Installation

1. First, install the required dependency:

```bash
pnpm install @superset-ui/embedded-sdk
```

2. Copy the `SupersetEmbed.vue` component into your project's components directory.

## Component Props

The component accepts the following props:

| Prop              | Type   | Required | Default                   | Description                                               |
| ----------------- | ------ | -------- | ------------------------- | --------------------------------------------------------- |
| `dashboardId`     | String | Yes      | -                         | The unique ID of the Superset dashboard you want to embed |
| `supersetDomain`  | String | No       | `'http://localhost:8088'` | The URL of your Superset instance                         |
| `supersetEmbedId` | String | No       | `'superset-embed-id'`     | The HTML element ID where the dashboard will be mounted   |
| `guestToken`      | String | Yes      | -                         | The guest token for authentication                        |

## Usage

### Basic Implementation

Here's how to use the SupersetEmbed component in your Vue application:

```vue
<template>
  <div class="dashboard-container">
    <h1>My Analytics Dashboard</h1>
    <SupersetEmbed
      :dashboard-id="dashboardId"
      :superset-domain="supersetDomain"
      :guest-token="guestToken"
    />
  </div>
</template>

<script setup lang="ts">
import SupersetEmbed from './components/SupersetEmbed.vue'
import { ref } from 'vue'

// These values would typically come from your backend API
const dashboardId = ref('your-dashboard-id-here')
const supersetDomain = ref('https://your-superset-instance.com')
const guestToken = ref('your-guest-token-here')
</script>

<style scoped>
.dashboard-container {
  padding: 20px;
}
</style>
```

### Custom Element ID

If you need multiple dashboards or want to use a custom element ID:

```vue
<template>
  <SupersetEmbed
    :dashboard-id="dashboardId"
    :superset-domain="supersetDomain"
    :guest-token="guestToken"
    :superset-embed-id="customEmbedId"
  />
</template>

<script setup lang="ts">
import SupersetEmbed from './components/SupersetEmbed.vue'

const dashboardId = 'dashboard-123'
const supersetDomain = 'https://analytics.example.com'
const guestToken = 'token-xyz'
const customEmbedId = 'my-custom-dashboard-container'
</script>
```

## Guest Token Authentication

The component requires a guest token for authentication. This token should be generated by your backend server. Here's a typical flow:

1. Your Vue app requests a guest token from your backend API
2. Your backend generates a guest token using Superset's API
3. The token is passed to the SupersetEmbed component
4. The component uses this token to authenticate and load the dashboard

Example backend request (in your Vue app):

```typescript
// api/superset.ts
export async function getGuestToken(dashboardId: string): Promise<string> {
  const response = await fetch('/api/superset/guest-token', {
    method: 'POST',
    headers: {
      'Content-Type': 'application/json',
    },
    body: JSON.stringify({ dashboardId }),
  })

  const data = await response.json()
  return data.guestToken
}
```

## Dashboard Configuration

The component comes with predefined dashboard UI configuration:

- **Hidden elements**: Title, tabs, and chart controls are hidden
- **Filters**: Collapsed and invisible by default
- **URL parameters**: Standalone mode enabled with active tab set to 1

These settings can be modified in the component's source code if needed:

```typescript
dashboardUiConfig: {
  hideTitle: true,
  hideTab: true,
  filters: {
    expanded: false,
    visible: false,
  },
  urlParams: { standalone: 3, activeTab: 1 },
  hideChartControls: true,
}
```

## Complete Example

Here's a complete example showing how to integrate the component with token fetching:

```vue
<template>
  <div class="app">
    <div v-if="loading">Loading dashboard...</div>
    <div v-else-if="error" class="error">{{ error }}</div>
    <SupersetEmbed
      v-else
      :dashboard-id="dashboardId"
      :superset-domain="supersetDomain"
      :guest-token="guestToken"
    />
  </div>
</template>

<script setup lang="ts">
import { ref, onMounted } from 'vue'
import SupersetEmbed from './components/SupersetEmbed.vue'
import { getGuestToken } from './api/superset'

const dashboardId = ref('your-dashboard-id')
const supersetDomain = ref(import.meta.env.VITE_SUPERSET_DOMAIN || 'http://localhost:8088')
const guestToken = ref('')
const loading = ref(true)
const error = ref('')

onMounted(async () => {
  try {
    guestToken.value = await getGuestToken(dashboardId.value)
    loading.value = false
  } catch (err) {
    error.value = 'Failed to load dashboard. Please try again.'
    loading.value = false
    console.error('Error fetching guest token:', err)
  }
})
</script>

<style scoped>
.app {
  max-width: 1200px;
  margin: 0 auto;
  padding: 20px;
}

.error {
  color: red;
  padding: 20px;
  text-align: center;
}
</style>
```

## Environment Variables

It's recommended to use environment variables for your Superset configuration:

```bash
# .env
VITE_SUPERSET_DOMAIN=https://your-superset-instance.com
VITE_API_BASE_URL=https://your-api.com
```

Then in your component:

```typescript
const supersetDomain = ref(import.meta.env.VITE_SUPERSET_DOMAIN)
```

## Additional Resources

- [Apache Superset Documentation](https://superset.apache.org/docs/intro)
- [Superset Embedded SDK Documentation](https://www.npmjs.com/package/@superset-ui/embedded-sdk)
- [Vue 3 Documentation](https://vuejs.org/guide/introduction.html)
- [Vite Documentation](https://vitejs.dev/guide/)
